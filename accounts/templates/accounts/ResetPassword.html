<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reset Password Page</title>
    <style>
        *{
            font-family: 'Roboto', sans-serif;
        }
        .input-form {
            display: flex;
            justify-items: flex-start;
            margin-bottom: 35px;
        }
        .input-form__label {
            font-size: 20px;
            line-height: 19px;
        }
        .input-form__field {
            width: 350px;
            height: 30px;
            padding: 10px 20px;
        }
    </style>
</head>
<body>
    <div style="max-width: 400px; margin: 10% auto;">
        <h1 style="margin-bottom: 30px">Reset your password</h1>
        <div class="input-form">
            <label for="new-password" class="input-form__label">New password</p>
            <input id="pass" name="new-password" type="password" placeholder="Enter new password" class="input-form__field"/>
        </div>
        <div>
            <label for="new-password" class="input-form__label">Confirmation</p>
            <input id="confirm" name="new-password" type="password" placeholder="Confirm new password" class="input-form__field"/>
        </div>
        <a href="http://localhost:8080/"><button id="post-btn" style="width: 100%; height: 45px; color: #fff; margin-top: 30px; background: #6900FF; border-radius: 26px;">UPDATE PASSWORD</button></a>
    </div>
    <script>
            function passwordValidation(password) {
                let passwordFormat = /^(?=.*\d)(?=.*[a-z])[0-9a-zA-Z]{8,}$/;
                if(password.match(passwordFormat)) {
                    return true;
                } else {
                    console.log("Password should contain at least one numeric digit, and lowercase letter. Minimum length is 8")
<!--                    this.inputError.password = "Password should contain at least one numeric digit, and lowercase letter. Minimum length is 8";-->
                    return false;
                }
            }

            const button = document.getElementById('post-btn');

            button.addEventListener('click', async _ => {
                let value1 = document.getElementById("pass").value;
                let value2 = document.getElementById("confirm").value;
                if (value1 == value2) {
                    let x = passwordValidation(value1)
                    if(x){
                        console.log("good")
                        try {
                            const response = await fetch('http://127.0.0.1:8000/reset-password-confirm/', {
                                method: 'post',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify({
                                    uid: "{{uid}}",
                                    token: "{{token}}",
                                    new_password: value1,
                                    re_new_password: value1
                                })
                            });
                            console.log('Completed!', response);
                        } catch(err) {
                            console.error(err);
                        }
                    }
                }
                else {
                    alert("ne sovpadaiut")
                }
            });
        </script>
</body>
</html>